#!/bin/bash

seek_dir () {
#    dfas dfa/fdafsd/fdafd/afkdjsakf/PlamoBuild*

    DIR=${1%/*}
    SCN=${1##*/}
    CAT=${DIR%/*}
    BASE=${DIR##*/}
    echo $DIR
    echo $SCN
    echo $CAT
    echo $BASE

    echo "pushd $DIR"
    echo "sh ./$SCN download config build package |& tee $BASE.log"
    echo "popd"
    pushd $DIR
    if [ -f $BASE.make.log ] ; then
	mv $BASE.make.log $BASE.make.log.1
    fi
    if [ -f $BASE.pakcgae.log ] ; then
	mv $BASE.pakcgae.log $BASE.pakcgae.log.1
    fi
    sh ./$SCN download config build |& tee $BASE.make.log
    sudo sh ./$SCN package |& tee $BASE.pakcgae.log
    popd
}

if [ $# = 1 ] ; then
    seek_dir $1 ;
else
    echo "usage: $0 [buildscript_dir]"
fi

